---
title: "A Grammar of Graphics"
format: stat20slides-revealjs
---

    
# Concept Questions
    
##

```{r}
#| fig-align: center
#| fig-width: 11
library(tidyverse)
library(palmerpenguins)

ggplot(penguins, aes(x = bill_length_mm,
                     y = species)) +
    geom_boxplot() +
    theme_gray(base_size = 20)
```

:::{.poll}
1. What are the aesthetics and geometry of this plot?
:::

{{< countdown "1:00" >}}


:::{.notes}
Correct answer: see code above.

This is a warm up to get them thinking about the fundamental concept of aesthetic mappings and geometries on a plot style and data set they'll be familiar with. This should be quite easy.
:::

## 

```{r}
ggplot(penguins, aes(x = island,
                     fill = island)) +
  geom_bar() +
  theme_gray(base_size = 20)
```

:::{.poll}
What code was used to make this plot?
:::

{{< countdown "1:00" >}}

:::{.notes}
Correct answer: see above.

This demonstrates a practice called "double-mapping", when the same column is mapped to two different aesthetic attributes. Most consider this a bad practice.

In a setting like this, usually the author is really just trying to get more color onto the plot. That can be accomplished by _setting_ the color of the bars using something like:

```{r}
#| eval: false
ggplot(penguins, aes(x = island)) +
  geom_bar(fill="blue")
```
:::

##

#### Global infectious disease prevalence in 1989

![](images/bubble-chart.png){fig-align="center" fig-alt="A bubble chart showing the prevalence of different infectious diseases. Each disease is represented by a bubble, its size is mapped to the prevalance, and it's biological family is mapped to color. The largest bubble is labeled HIV and is green, representing viruses."}

:::{.poll}
2. What are the aesthetics and geometry of this plot?
:::

{{< countdown "1:00" >}}

:::{.notes}
Correct answer: Color is mapped to taxonomic family, size is mapped to prevalence, the diseases are represented using the point geometry.

Good follow up questions and boardwork include:

- What does the data frame look like that made this plot?
- What determines where the bubbles are placed in the chart? Answer: bubble charts have different methods of doing this. This one appears to use a packing algorithm so get them close together. Important, none of those methods refer to a column in the data frame therefore are not aesthetic mappings.
- If you really want to go far afield, you could show an example of a beeswarm chart, which is a bubble chart that uses one of the x or the y to map a numerical variable and then uses a packing algorithm to determine placement on the other axis.
- One of the lessons of this bubble chart is that our "named" charts correspond to particular combos of aesthetic mappings and geometriess. A "scatterplot" uses the point geometry and maps numerical data to the x and y axes. A "bubble chart" uses the point geometry too, but maps size to a numerical variable (and often uses color too).
:::

    
# Concept Activity

<!--


##

:::{.poll}
What has changed when moving from the left to the right?
:::

```{r}
#| fig-align: center
#| fig-width: 11
library(patchwork)
p1 <- ggplot(penguins, aes(x = bill_length_mm,
                           y = bill_depth_mm,
                           color = species)) +
    geom_point(size=2) +
    theme_gray(base_size = 20) +
    theme(legend.position = "none")
p2 <- ggplot(penguins, aes(x = bill_length_mm,
                           y = bill_depth_mm,
                           shape = species)) +
    geom_point(size=2) +
    theme_gray(base_size = 20) +
    theme(legend.position = "none")
p1 + p2
```

```{r}
countdown::countdown(1, top = 0)
```

-->

## Concept Activity

You will be watching a 2.5 minute video of a presentation by a scientist, Hans Rosling, who studied global public health. He presents data visualizations depicting the change in life expectancy and family size over several decades in the 20th century.

:::{.poll}
On a piece of note paper:

- Sketch out the data frame used to create the graphic and add the names of the variables.
- List the aesthetic attributes used to encode the data in the graphic.
- Identify the geometry used in the plot.
:::

## {data-menu-title="Hans Rosling's Gapminder"}

<center>
<iframe src="https://embed.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen" width="854" height="480" style="position:absolute;left:0;top:0;width:100%;height:100%" frameborder="0" scrolling="no" allowfullscreen></iframe>
</center>

##

Please turn to your neighbors and...

:::{.poll}
Discuss what you came up with in terms of . . .

- the variables present in the data frame
- the aesthetic attributes used to encode that data in the plot
- the geometry
:::

{{< countdown "1:00" >}}


## What were the variables and aesthetic attributes?

. . .

:::: {.columns}

::: {.column width="50%"}

#### Visual Cues / Aesthetics

- Location along the x-axis
- Location along the y-axis
- Size of point
- Color of point
- Animation
:::

::: {.column width="50%"}
#### Variables

- Fertility rate
- Life expectancy
- Population
- Region
- Year
:::

::::


## What did the data frame look like?


What was the unit of observation? What were the variables? What were their type?

. . . 

:::: {.columns}

::: {.column width="50%"}
#### Unit of observation

- A country in a given year
:::

::: {.column width="50%"}
#### Variables

- Fertility rate (continuous)
- Life expectancy (continuous)
- Population (continuous)
- Region (nominal)
- Year (discrete)
:::

::::

```{r}
#| echo: false
#| eval: false
## don't use the gapminder package data. Remake to have the original vars: life expectancy and fertility rate
library(gapminder)
gapminder |>
  slice(1, 10) |>
  kable() |>
  kable_styling(latex_options = "striped")
```


## What geometry is used to represent the observations?

. . .

- Points

# Quiz Recap

-   Head to `pollev.com` for a series of former quiz questions and quiz-level questions! *Make sure you take notes*. 

## What type of claim was made?

> The group *Morning Consult* conducted a poll of a representative sample of registered 1,256 Republican voters on August 24, 2023, asking them who they planned to vote for in the primary eleection. 58% of respondents replied "Trump" and 14% replied "DeSantis". A major news outlet ran a headline, "Trump leads DeSantis by 44 points among registered Republican voters."
. . . 

{{< countdown "1:00" >}}

## What type of variable is listeners?

![](images/spotify.png){fig-alt="A dataframe with a column labelled 'Listeners (in million)' with values 40, 66, 60, 73, 57, 75, and 13'}

. . . 

{{< countdown "1:00" >}}


## What type of proportion is used?

![](images/q1.png){fig-alt="An image of a stacked bar chart with the classes along the x-asis - 1, 2, and 3 - and the bars filled with black or gray based the proportion that survived or perished."}

. . . 

> Roughly 68 percent of those passengers who were in the first class survived the wreckage of the Titanic. 

. . . 

{{< countdown "1:00" >}}

## Which measure of center/spread is least appropriate?

```{r}
library(patchwork)
library(stat20data)

p1 <- penguins |>
  filter(species == "Gentoo",
         sex == "male") |>
  ggplot(mapping = aes(x = body_mass_g)) +
  geom_histogram(color = "white",
                 bins = 10) +
  labs(title = "Image 1")


p2 <- class_survey |>
  filter(covid >0,
         covid < 1) |>
  ggplot(mapping = aes(x = covid)) +
  geom_histogram(color = "white", bins = 10) +
  labs(title = "Image 2")

p1 / p2

```

{{< countdown "1:00" >}}

## What are the aesthetics and geometry of this plot?

```{r}
#| fig-align: center
#| fig-width: 11
library(tidyverse)
library(palmerpenguins)

ggplot(penguins, aes(x = bill_length_mm,
                     fill = species)) +
    geom_density() +
    theme_gray(base_size = 20)
```

. . . 

{{< countdown "1:00" >}}

## What has not changed when moving from left to right?

```{r}
#| fig-align: center
#| fig-width: 11
library(patchwork)
p1 <- ggplot(penguins, aes(x = bill_length_mm,
                           y = bill_depth_mm,
                           color = species)) +
    geom_point(size=2) +
    theme_gray(base_size = 20) +
    theme(legend.position = "none") 
p2 <- ggplot(penguins, aes(x = bill_length_mm,
                           y = bill_depth_mm,
                           shape = species)) +
    geom_point(size=5, alpha = .5) +
    theme_bw(base_size = 20) +
    lims(y = c(10,24)) +
    theme(legend.position = "none") +
    xlab("Bill Length (in millimeters)") +
    annotate(geom = "text", x = 45, y = 11,
             label = "Gentoo", size = 5) +
    annotate(geom = "segment", x = 45, y = 11.2,
             xend = 45, yend = 13, 
             size = 1)
p1 + p2
```

# Break

{{< countdown "5:00" >}}

# Worksheet: A Grammar of Graphics

{{< countdown "15:00" >}}