---
title: "Class Survey Data Frame"
format: typst
---

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false

library(tidyverse)
df <- read_csv("class-survey-raw.csv")

# Drop a few cols that are inappropriate for analysis
df <- df |>
  select(-1, -2, -7, -8, -29)

# Provide more concise column names
names(df) <- c("time_at_cal", "major", "coding_exp_words", "coding_exp_scale",
               "languages", "favorite_cal", "piercings", "pets_and_sibs", 
               "diet", "prof_label", "study_place", "olympics", "season", "mts_beach",
               "coffee_tea", "tech_relationships", "climate", "crypto", "ai",
               "covid", "fire_alarm", "election", "hotdogs", "horse_duck")

# Create tech, health, and business variables
#Create the Health variable with all No's
df$health <- "No"
#Find the row indices of health-related majors.
ind_health <- which(stringr::str_detect(unlist(df$major), "[B|b]io|[H|h]ealth|[P|p]sycho|[C|c]og|[N|n]utrition|MEB|[M|m][C|c][B|b]"))
#Update the Health variable to Yes for these rows.
df$health[ind_health] <- "Yes"

# Similarly create the variables for tech and business related majors.
df$tech <- "No"
ind_tech <- which(str_detect(unlist(df$major), "[S|s]tat|[C|c]omputer|CS|EECS|eecs|[E|e]ngineering|[D|d]ata|DS|[A|a]pplied [M|m]ath|Compsci"))
df$tech[ind_tech] <- "Yes"

# Business
df$business <- "No"
ind_business <- which(str_detect(unlist(df$major), "[E|e]con|[B|b]usiness|[H|h]aas | [M]management |Polecon"))
df$business[ind_business] <- "Yes"


##Clean up Covid probability related variables
#Find row indices of all entries not between zero and one. 
#Update them to zero.
#Unlist the column and convert it to numeric.

```

```{r}
#| echo: false
#| eval: false
df |>
  drop_na() |>
  glimpse()
```


```{r}
#| echo: false
#| eval: true
library(stat20data)
class_survey |>
  glimpse()
```


